<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bybit Trading Bot - Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="/static/css/style.css" rel="stylesheet">
</head>
<body>
    <div class="container-fluid">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">
                    <i class="bi bi-robot"></i> Trading Bot
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto gap-3">
                        <li class="nav-item">
                            <span class="nav-link" id="connectionStatus">
                                <span class="badge bg-danger">Offline</span>
                            </span>
                        </li>
                        <li class="nav-item">
                            <span class="nav-link" id="currentTime"></span>
                        </li>
                        <li class="nav-item">
                            <span class="nav-link" id="userInfo">
                                üë§ Guest
                            </span>
                        </li>
                        <li class="nav-item">
                            <button class="btn btn-sm btn-outline-danger" id="logoutBtn" onclick="logout()" style="display: none;">
                                <i class="bi bi-box-arrow-right"></i> Logout
                            </button>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <div class="row mt-4">
            <!-- –õ–µ–≤–∞—è –±–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
            <div class="col-md-2">
                <div class="d-flex flex-column gap-2">
                    <button class="btn btn-primary active" data-tab="dashboard">
                        <i class="bi bi-speedometer2"></i> Dashboard
                    </button>
                    <button class="btn btn-outline-primary" data-tab="settings">
                        <i class="bi bi-gear"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                    </button>
                    <button class="btn btn-outline-primary" data-tab="history">
                        <i class="bi bi-clock-history"></i> –ò—Å—Ç–æ—Ä–∏—è
                    </button>
                    <button class="btn btn-outline-primary" data-tab="signals-log">
                        <i class="bi bi-bug"></i> –õ–æ–≥–∏ –°–∏–≥–Ω–∞–ª–æ–≤
                    </button>
                    <button class="btn btn-outline-primary" data-tab="account">
                        <i class="bi bi-wallet2"></i> –ê–∫–∫–∞—É–Ω—Ç
                    </button>
                </div>
            </div>

            <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
            <div class="col-md-10">
                <!-- DASHBOARD TAB -->
                <div id="dashboard" class="tab-content active">
                    <h2 class="mb-4">Dashboard</h2>

                    <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º -->
                    <div class="row mb-4">
                        <div class="col-md-12">
                            <div class="btn-group" role="group">
                                <button type="button" class="btn btn-success btn-lg" id="startBotBtn" onclick="startBot()">
                                    <i class="bi bi-play-fill"></i> –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
                                </button>
                                <button type="button" class="btn btn-danger btn-lg" id="stopBotBtn" onclick="stopBot()" disabled>
                                    <i class="bi bi-stop-fill"></i> –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
                                </button>
                            </div>
                            <div id="botStatusMessage" class="mt-2"></div>
                        </div>
                    </div>

                    <!-- –°—Ç–∞—Ç—É—Å –±–æ—Ç–∞ -->
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="card">
                                <div class="card-body">
                                    <h6 class="card-title">–†–µ–∂–∏–º</h6>
                                    <p class="card-text fs-5" id="botMode">-</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card">
                                <div class="card-body">
                                    <h6 class="card-title">–°–∏–º–≤–æ–ª</h6>
                                    <p class="card-text fs-5" id="botSymbol">-</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card">
                                <div class="card-body">
                                    <h6 class="card-title">–°—Ç–∞—Ç—É—Å</h6>
                                    <p class="card-text fs-5">
                                        <span class="badge bg-warning" id="botStatus">Stopped</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card">
                                <div class="card-body">
                                    <h6 class="card-title">–†–∏—Å–∫</h6>
                                    <p class="card-text fs-5" id="riskPercent">-</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- –ë–∞–ª–∞–Ω—Å -->
                    <div class="row mb-4">
                        <div class="col-md-4">
                            <div class="card bg-success text-white">
                                <div class="card-body">
                                    <h6 class="card-title">–ë–∞–ª–∞–Ω—Å</h6>
                                    <p class="card-text fs-5" id="totalBalance">$0.00</p>
                                    <small>–í—Å–µ–≥–æ</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-info text-white">
                                <div class="card-body">
                                    <h6 class="card-title">PnL</h6>
                                    <p class="card-text fs-5" id="unrealizedPnl">$0.00</p>
                                    <small>–ù–µ—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-secondary text-white">
                                <div class="card-body">
                                    <h6 class="card-title">–ü–æ–∑–∏—Ü–∏–∏</h6>
                                    <p class="card-text fs-5" id="positionCount">0</p>
                                    <small>–û—Ç–∫—Ä—ã—Ç—ã—Ö</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏ -->
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="mb-0">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤</h6>
                                </div>
                                <div class="card-body">
                                    <div id="signalStats">
                                        <p class="text-muted">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="mb-0">–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–∏–≥–Ω–∞–ª—ã</h6>
                                </div>
                                <div class="card-body">
                                    <div id="recentSignals" style="max-height: 300px; overflow-y: auto;">
                                        <p class="text-muted">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SETTINGS TAB -->
                <div id="settings" class="tab-content" style="display: none;">
                    <h2 class="mb-4">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="mb-0">–¢–æ—Ä–≥–æ–≤–ª—è</h6>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label class="form-label">–¢–æ—Ä–≥–æ–≤—ã–µ –ü–∞—Ä—ã</label>
                                        <input type="text" class="form-control" id="settingSymbols" 
                                               placeholder="BTCUSDT, ETHUSDT, SOLUSDT" 
                                               title="–í–≤–µ–¥–∏ –ø–∞—Ä—ã —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é">
                                        <small class="form-text text-muted">–ü–∞—Ä—ã —Ä–∞–∑–¥–µ–ª—è–π –∑–∞–ø—è—Ç–æ–π –∏ –ø—Ä–æ–±–µ–ª–æ–º</small>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">–û—Å–Ω–æ–≤–Ω–∞—è –ø–∞—Ä–∞</label>
                                        <input type="text" class="form-control" id="settingSymbol" placeholder="BTCUSDT">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">–†–µ–∂–∏–º</label>
                                        <select class="form-select" id="settingMode">
                                            <option value="paper">Paper</option>
                                            <option value="live">Live</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="mb-0">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏</h6>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label class="form-label">–†–∏—Å–∫ –ø–æ–∑–∏—Ü–∏–∏ (%)</label>
                                        <input type="number" class="form-control" id="settingRiskPercent" min="0.1" max="10" step="0.1">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –ø–ª–µ—á–æ</label>
                                        <input type="number" class="form-control" id="settingMaxLeverage" min="1" max="100" step="1">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-3">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="mb-0">–°—Ç–æ–ø—ã –∏ –ø—Ä–æ—Ñ–∏—Ç—ã</h6>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label class="form-label">Stop Loss (%)</label>
                                        <input type="number" class="form-control" id="settingStopLoss" min="0.1" max="10" step="0.1">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Take Profit (%)</label>
                                        <input type="number" class="form-control" id="settingTakeProfit" min="0.1" max="50" step="0.1">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="mb-0">–î–µ–π—Å—Ç–≤–∏—è</h6>
                                </div>
                                <div class="card-body">
                                    <button class="btn btn-success w-100 mb-2" id="savSettingsBtn">
                                        <i class="bi bi-check"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                                    </button>
                                    <button class="btn btn-warning w-100" id="resetSettingsBtn">
                                        <i class="bi bi-arrow-clockwise"></i> –°–±—Ä–æ—Å–∏—Ç—å –Ω–∞ –¥–µ—Ñ–æ–ª—Ç—ã
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- HISTORY TAB -->
                <div id="history" class="tab-content" style="display: none;">
                    <h2 class="mb-4">–ò—Å—Ç–æ—Ä–∏—è —Ç–æ—Ä–≥–æ–≤–ª–∏</h2>

                    <ul class="nav nav-tabs mb-3" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" data-bs-toggle="tab" href="#signaslTab">–°–∏–≥–Ω–∞–ª—ã</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#ordersTab">–û—Ä–¥–µ—Ä–∞</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#executionsTab">–ò—Å–ø–æ–ª–Ω–µ–Ω–∏—è</a>
                        </li>
                    </ul>

                    <div class="tab-content">
                        <!-- –°–∏–≥–Ω–∞–ª—ã -->
                        <div id="signaslTab" class="tab-pane fade show active">
                            <div class="table-responsive">
                                <table class="table table-sm table-hover">
                                    <thead class="table-dark">
                                        <tr>
                                            <th>–í—Ä–µ–º—è</th>
                                            <th>–°—Ç—Ä–∞—Ç–µ–≥–∏—è</th>
                                            <th>–°–∏–º–≤–æ–ª</th>
                                            <th>–¢–∏–ø</th>
                                            <th>–¶–µ–Ω–∞</th>
                                        </tr>
                                    </thead>
                                    <tbody id="signalsTable">
                                        <tr>
                                            <td colspan="5" class="text-center text-muted">–ó–∞–≥—Ä—É–∑–∫–∞...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- –û—Ä–¥–µ—Ä–∞ -->
                        <div id="ordersTab" class="tab-pane fade">
                            <div class="table-responsive">
                                <table class="table table-sm table-hover">
                                    <thead class="table-dark">
                                        <tr>
                                            <th>ID</th>
                                            <th>–°–∏–º–≤–æ–ª</th>
                                            <th>–°—Ç–æ—Ä–æ–Ω–∞</th>
                                            <th>–¢–∏–ø</th>
                                            <th>–¶–µ–Ω–∞</th>
                                            <th>–ö–æ–ª-–≤–æ</th>
                                            <th>–°—Ç–∞—Ç—É—Å</th>
                                        </tr>
                                    </thead>
                                    <tbody id="ordersTable">
                                        <tr>
                                            <td colspan="7" class="text-center text-muted">–ó–∞–≥—Ä—É–∑–∫–∞...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- –ò—Å–ø–æ–ª–Ω–µ–Ω–∏—è -->
                        <div id="executionsTab" class="tab-pane fade">
                            <div class="table-responsive">
                                <table class="table table-sm table-hover">
                                    <thead class="table-dark">
                                        <tr>
                                            <th>ID</th>
                                            <th>–°–∏–º–≤–æ–ª</th>
                                            <th>–°—Ç–æ—Ä–æ–Ω–∞</th>
                                            <th>–¶–µ–Ω–∞</th>
                                            <th>–ö–æ–ª-–≤–æ</th>
                                            <th>–ö–æ–º–∏—Å—Å–∏—è</th>
                                            <th>–í—Ä–µ–º—è</th>
                                        </tr>
                                    </thead>
                                    <tbody id="executionsTable">
                                        <tr>
                                            <td colspan="7" class="text-center text-muted">–ó–∞–≥—Ä—É–∑–∫–∞...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SIGNALS LOG TAB -->
                <div id="signals-log" class="tab-content" style="display: none;">
                    <h2 class="mb-4">
                        <i class="bi bi-bug"></i> –õ–æ–≥–∏ –°–∏–≥–Ω–∞–ª–æ–≤ - –û—Ç–ª–∞–¥–∫–∞
                    </h2>
                    
                    <div class="alert alert-info mb-4">
                        <strong>üí° –°–æ–≤–µ—Ç:</strong> –ó–¥–µ—Å—å –≤—ã –≤–∏–¥–∏—Ç–µ –í–°–ï —Å–∏–≥–Ω–∞–ª—ã —Å –∏—Ö —Å—Ç–∞—Ç—É—Å–æ–º (–ø—Ä–∏–Ω—è—Ç—ã/–æ—Ç–∫–ª–æ–Ω–µ–Ω—ã) –∏ –ø—Ä–∏—á–∏–Ω–∞–º–∏. 
                        –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏, –µ—Å–ª–∏ –æ—Ä–¥–µ—Ä–∞ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è.
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <div class="input-group">
                                <select class="form-control" id="signalLogLevel">
                                    <option value="all">–í—Å–µ –ª–æ–≥–∏</option>
                                    <option value="info">–¢–æ–ª—å–∫–æ —É—Å–ø–µ—à–Ω—ã–µ</option>
                                    <option value="warning">–¢–æ–ª—å–∫–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ</option>
                                    <option value="error">–¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏</option>
                                </select>
                                <button class="btn btn-outline-secondary" onclick="loadSignalLogs()">
                                    <i class="bi bi-arrow-clockwise"></i> –û–±–Ω–æ–≤–∏—Ç—å
                                </button>
                                <button class="btn btn-outline-danger" onclick="clearSignalLogs()">
                                    <i class="bi bi-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å
                                </button>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="input-group">
                                <input type="number" class="form-control" id="signalLogLimit" value="50" min="10" max="500" placeholder="–ö–æ–ª-–≤–æ –ª–æ–≥–æ–≤">
                                <button class="btn btn-outline-secondary" onclick="loadSignalLogs()">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <strong>–õ–æ–≥–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</strong>
                            <span class="badge bg-secondary float-end" id="signalLogCount">0 –ª–æ–≥–æ–≤</span>
                        </div>
                        <div class="card-body" style="max-height: 600px; overflow-y: auto; background-color: #1e1e1e;">
                            <div id="signalLogsContainer">
                                <p class="text-muted">–ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ–≤...</p>
                            </div>
                        </div>
                    </div>

                    <div class="mt-3 alert alert-secondary">
                        <strong>üìã –ß—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å:</strong>
                        <ul class="mb-0 mt-2">
                            <li><code class="text-success">‚úÖ SIGNAL GENERATED</code> - –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–æ–∑–¥–∞–ª–∞ —Å–∏–≥–Ω–∞–ª</li>
                            <li><code class="text-success">‚úÖ SIGNAL ACCEPTED</code> - –°–∏–≥–Ω–∞–ª –ø—Ä–æ—à–µ–ª –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –æ—Ä–¥–µ—Ä –æ—Ç–∫—Ä—ã—Ç</li>
                            <li><code class="text-danger">‚ùå SIGNAL REJECTED</code> - –°–∏–≥–Ω–∞–ª –æ—Ç–∫–ª–æ–Ω–µ–Ω (–ø—Ä–∏—á–∏–Ω–∞ –≤ –ª–æ–≥–µ)</li>
                            <li><code class="text-danger">‚ùå ORDER EXEC FAILED</code> - –û—Ä–¥–µ—Ä –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω (–ø—Ä–∏—á–∏–Ω–∞ –≤ –ª–æ–≥–µ)</li>
                        </ul>
                    </div>
                </div>

                <!-- ACCOUNT TAB -->
                <div id="account" class="tab-content" style="display: none;">
                    <h2 class="mb-4">–ê–∫–∫–∞—É–Ω—Ç</h2>

                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="mb-0">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞</h6>
                                </div>
                                <div class="card-body" id="accountInfo">
                                    <p class="text-muted">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="mb-0">–ë–∞–ª–∞–Ω—Å—ã</h6>
                                </div>
                                <div class="card-body" id="balanceInfo">
                                    <p class="text-muted">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            <h6 class="mb-0">–û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏</h6>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-sm table-hover">
                                    <thead class="table-dark">
                                        <tr>
                                            <th>–°–∏–º–≤–æ–ª</th>
                                            <th>–°—Ç–æ—Ä–æ–Ω–∞</th>
                                            <th>–†–∞–∑–º–µ—Ä</th>
                                            <th>–¶–µ–Ω–∞ –≤—Ö–æ–¥–∞</th>
                                            <th>–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞</th>
                                            <th>PnL</th>
                                            <th>PnL %</th>
                                        </tr>
                                    </thead>
                                    <tbody id="positionsTable">
                                        <tr>
                                            <td colspan="7" class="text-center text-muted">–ù–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/app.js"></script>
</body>
</html>
