# Bot Configuration File
# Все настройки бота в одном месте
# Легко менять как программно, так и из UI в будущем

# ============================================================================
# ОСНОВНЫЕ НАСТРОЙКИ
# ============================================================================
bot:
  name: "Bybit Trading Bot"
  version: "1.0"
  # Режим работы: 'paper' (симуляция), 'backtest' (история), 'live' (реальные деньги)
  mode: "paper"
  # Использовать testnet или mainnet
  testnet: true
  # Торговый символ
  symbol: "BTCUSDT"
  # Таймфрейм свечей (минуты)
  timeframe: 60
  # Логировать ли debug информацию
  debug: false

# ============================================================================
# ТОРГОВЫЕ ПАРАМЕТРЫ
# ============================================================================
trading:
  # Начальный баланс для paper/backtest режима
  initial_balance: 10000.0
  # Максимальное количество открытых позиций одновременно
  max_positions: 1
  # Минимальный размер ордера в USDT
  min_order_size: 10.0
  # Максимальный размер ордера в USDT
  max_order_size: 1000.0

# ============================================================================
# УПРАВЛЕНИЕ РИСКАМИ
# ============================================================================
risk:
  # Риск на одну сделку (% от баланса)
  risk_per_trade: 1.0
  # Максимальное кредитное плечо
  max_leverage: 10.0
  # Максимальное количество убыточных сделок подряд
  max_drawdown_percent: 10.0
  # Максимальный размер позиции (% от баланса)
  max_position_size_percent: 5.0
  # Стоп-лосс в процентах от входной цены
  stop_loss_percent: 2.0
  # Тейк-профит в процентах от входной цены
  take_profit_percent: 5.0

# ============================================================================
# ПАРАМЕТРЫ API И ПЕРЕПОДКЛЮЧЕНИЯ
# ============================================================================
api:
  # Timeout для REST запросов (сек)
  rest_timeout: 10
  # Timeout для WebSocket (сек)
  ws_timeout: 30
  # Максимальное количество retry попыток
  max_retries: 3
  # Начальная задержка для retry (сек)
  retry_initial_delay: 0.5
  # Множитель задержки (exponential backoff)
  retry_backoff_factor: 2.0
  # Максимальная задержка между retry (сек)
  retry_max_delay: 10.0
  # Интервал переподключения WebSocket (сек)
  ws_reconnect_interval: 5

# ============================================================================
# ПАРАМЕТРЫ СТРАТЕГИЙ
# ============================================================================
strategies:
  # Включить стратегию TrendPullback
  trend_pullback:
    enabled: true
    # RSI периоды для боков и переворотов
    rsi_period: 14
    rsi_oversold: 30
    rsi_overbought: 70
    # MACD параметры
    macd_fast: 12
    macd_slow: 26
    macd_signal: 9
    # Минимальное количество баров для подтверждения
    min_bars_confirmation: 3
  
  # Включить стратегию Breakout
  breakout:
    enabled: true
    # Период для расчета highs/lows
    lookback_period: 20
    # Объем для подтверждения breakout (% от среднего)
    volume_confirm_percent: 120
    # Количество баров выше/ниже уровня для breakout
    breakout_bars: 2
  
  # Включить стратегию MeanReversion
  mean_reversion:
    enabled: true
    # Период Bollinger Bands
    bb_period: 20
    # Множитель стандартного отклонения для BB
    bb_std_dev: 2.0
    # Минимальное расстояние от средней для сигнала
    min_distance_from_mean: 1.5

# ============================================================================
# МЕТА-СЛОЙ (АРБИТРАЖ СИГНАЛОВ)
# ============================================================================
meta_layer:
  # Включить многотаймфреймовый анализ
  use_multi_timeframe: true
  # Таймфреймы для анализа конфлюэнса (минуты)
  timeframes:
    - 5
    - 15
    - 60
    - 240
    - 1440  # D
  # Минимальное количество стратегий для согласия
  min_strategy_agreement: 2
  # Минимальное количество таймфреймов для конфлюэнса
  min_timeframe_confluence: 2
  # Множитель для сигнала с высоким конфлюэнсом
  high_confluence_multiplier: 1.5

# ============================================================================
# ФИЧИ И ИНДИКАТОРЫ
# ============================================================================
features:
  # Включить расчет всех фич
  enabled: true
  # Период SMA для основного тренда
  sma_period: 50
  # Период EMA
  ema_period: 12
  # Параметры Bollinger Bands
  bb_period: 20
  bb_std_dev: 2.0
  # Параметры MACD
  macd_fast: 12
  macd_slow: 26
  macd_signal: 9
  # RSI период
  rsi_period: 14
  # ATR период для волатильности
  atr_period: 14
  # Период для объема
  volume_period: 20

# ============================================================================
# ХРАНИЛИЩЕ ДАННЫХ
# ============================================================================
storage:
  # Тип хранилища: 'sqlite', 'postgres', 'mongodb'
  type: "sqlite"
  # Путь к БД SQLite
  sqlite_path: "storage/bot_state.db"
  # Автоматически создавать таблицы
  auto_migrate: true
  # Максимальный размер лога ошибок (количество записей)
  max_error_log_size: 10000

# ============================================================================
# ЛОГИРОВАНИЕ
# ============================================================================
logging:
  # Уровень логирования: DEBUG, INFO, WARNING, ERROR, CRITICAL
  level: "INFO"
  # Путь к файлу логов
  file: "logs/bot.log"
  # Максимальный размер файла логов (MB)
  max_file_size: 50
  # Количество backup файлов
  backup_count: 5
  # Формат логирования
  format: "{time:YYYY-MM-DD HH:mm:ss} | {level: <8} | {name} | {message}"

# ============================================================================
# УВЕДОМЛЕНИЯ
# ============================================================================
notifications:
  # Включить уведомления
  enabled: false
  # Типы уведомлений: email, telegram, discord, slack
  channels:
    # Email уведомления
    email:
      enabled: false
      smtp_server: "smtp.gmail.com"
      smtp_port: 587
      from_email: "your-email@gmail.com"
      password: "${EMAIL_PASSWORD}"  # Из environment переменной
      to_emails:
        - "recipient@email.com"
    
    # Telegram
    telegram:
      enabled: false
      bot_token: "${TELEGRAM_BOT_TOKEN}"
      chat_id: "${TELEGRAM_CHAT_ID}"
    
    # Discord
    discord:
      enabled: false
      webhook_url: "${DISCORD_WEBHOOK_URL}"

# ============================================================================
# CIRCUIT BREAKER (АВТОМАТИЧЕСКОЕ ОТКЛЮЧЕНИЕ)
# ============================================================================
circuit_breaker:
  # Включить circuit breaker
  enabled: true
  # Максимальное количество ошибок подряд
  max_consecutive_errors: 5
  # Максимальное количество ошибок за час
  max_errors_per_hour: 20
  # Максимальный процент убытков за день
  max_daily_loss_percent: 5.0
  # Время восстановления после срабатывания (сек)
  recovery_time: 300

# ============================================================================
# DATA FETCHING (СБОР ДАННЫХ)
# ============================================================================
data:
  # Количество свечей для анализа
  kline_limit: 500
  # Глубина стакана для анализа orderflow
  orderbook_depth: 50
  # Интервал обновления данных (сек)
  update_interval: 12
  # Включить сбор деривативных данных (mark price, OI, funding)
  fetch_derivatives: true
  # Включить сбор данных orderflow
  fetch_orderflow: true

# ============================================================================
# BACKTEST ПАРАМЕТРЫ (для режима backtest)
# ============================================================================
backtest:
  # Дата начала
  start_date: "2024-01-01"
  # Дата окончания
  end_date: "2024-12-31"
  # Комиссия (в процентах)
  commission: 0.1
  # Проскальзывание (в процентах)
  slippage: 0.05
